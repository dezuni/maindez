<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E00MPED2X0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);} 
      gtag('js', new Date());
      gtag('config', 'G-E00MPED2X0');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾ÛŒØ´ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ø±Øª ØªØ®ÙÛŒÙ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- âœ… ÙÙˆÙ†Øª Vazirmatn -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">

    <!-- Ø³Ø§ÛŒØ± Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ -->
    <link rel="stylesheet" href="/style.css">

    <style>
        body, h1, h2, h3, h4, h5, h6, p, div, span, label, input, textarea, button, a, li {
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, sans-serif !important;
            font-feature-settings: "cv01", "cv02", "cv03", "cv04", "cv05", "cv06", "cv07", "cv08", "cv09", "cv10";
        }
        /* (Ú©Ø¯Ù‡Ø§ÛŒ CSS Ù‡Ù…Ø§Ù†Ù†Ø¯ Ù‚Ø¨Ù„ â€” Ø¨Ø±Ø§ÛŒ Ø®Ù„Ø§ØµÙ‡ Ø¨ÙˆØ¯Ù† Ø§ÛŒÙ†Ø¬Ø§ Ú©ÙˆØªØ§Ù‡ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯) */
        #vouchers-section { padding: 20px; background: #f9f9f9; border-radius: 12px; margin-bottom: 30px; }
        .vouchers-container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .voucher-card { background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); padding: 20px; width: 100%; max-width: 450px; transition: transform 0.2s; }
        .voucher-card:hover { transform: translateY(-3px); box-shadow: 0 6px 16px rgba(0,0,0,0.12); }
        .voucher-card.dimmed { opacity: 0.55; pointer-events: none; }
        .voucher-title { font-size: 1.3rem; font-weight: bold; color: #1e3a8a; margin-bottom: 16px; text-align: center; }
        .voucher-item { display: flex; justify-content: space-between; padding: 8px 0; font-size: 0.95rem; }
        .voucher-label { color: #6b7280; }
        .voucher-value.credit { color: #059669; font-weight: bold; }
        .voucher-value.discount { color: #dc2626; font-weight: bold; }
        .voucher-value.total { color: #3b82f6; font-weight: bold; }
        .voucher-value.inshop { color: #8b5cf6; font-weight: bold; }
        .voucher-value.advance { color: #d97706; font-weight: bold; }
        .divider { height: 1px; background: #e5e7eb; margin: 10px 0; }
        .deposit-link { display: block; background: linear-gradient(135deg, #fb8500, #ff9e10); color: white !important; text-align: center; padding: 12px; border-radius: 10px; margin-top: 16px; font-weight: bold; text-decoration: none; font-size: 1.05rem; transition: all 0.2s; }
        .deposit-link:hover:not(.disabled) { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(251, 133, 0, 0.3); }
        .deposit-link.disabled { background: #ccc !important; cursor: not-allowed; transform: none; box-shadow: none; }
        .help-link { display: block; text-align: center; color: #3b82f6; margin-top: 12px; font-size: 0.9rem; text-decoration: none; }
        .help-link:hover { text-decoration: underline; }
        .voucher-help-text { direction: rtl; text-align: right; margin-top: 12px; padding: 12px; background: #f8fafc; border-radius: 8px; font-size: 0.9rem; line-height: 1.6; color: #2c3e50; border: 1px solid #e2e8f0; }
        .address-text { direction: rtl; text-align: right; margin-top: 12px; padding: 12px; background: #fffbeb; border-radius: 8px; font-size: 0.9rem; line-height: 1.6; color: #854d0e; border: 1px solid #fed7aa; display: none; }
        #loading-vouchers { text-align: center; padding: 20px; color: #666; }
        #reservation-form { background: white; padding: 24px; border-radius: 14px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); margin: 20px auto 40px auto; max-width: 450px; width: 100%; display: none; }
        #reservation-form h3 { text-align: center; margin-bottom: 20px; color: #1e3a8a; font-weight: bold; }
        .formcontainer form { display: flex; flex-direction: column; gap: 16px; }
        .formcontainer label { display: flex; flex-direction: column; font-weight: 500; color: #4b5563; }
        .formcontainer input { padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem; direction: ltr; text-align: left; font-family: 'Vazirmatn', sans-serif; }
        .formcontainer input:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); }
        .formcontainer button { background: linear-gradient(135deg, #0ea5e9, #0284c7); color: white; border: none; padding: 12px; border-radius: 10px; font-size: 1.05rem; font-weight: bold; cursor: pointer; transition: all 0.2s; font-family: 'Vazirmatn', sans-serif; }
        .formcontainer button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(14, 165, 233, 0.4); }
        #DiscountRequestStatus { margin-top: 12px; text-align: center; color: #d32f2f; }
        #DiscountSuccessMessage { margin-top: 16px; padding: 16px; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; color: #065f46; text-align: center; display: none; }
        @media (max-width: 768px) { .vouchers-container { flex-direction: column; align-items: center; } .voucher-card { max-width: 100%; } }
    </style>
</head>
<body>
    <header>
        <div class="container-header">
            <div class="header-content">
                <button class="mobile-menu-toggle"><i class="fas fa-bars"></i></button>
                <div class="logo"><img src="/logo.png" alt="Ù„ÙˆÚ¯ÙˆÙŠ Ø¯Ø§Ù†Ø´Ú¯Ø§Ù‡" style="max-width: 40%; height: auto;"></div>
                <div class="header-text"><h2>Ø³Ø§Ù…Ø§Ù†Ù‡ Ø®Ø¯Ù…Ø§Øª Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒÛŒ</h2></div>
            </div>
        </div>
    </header>

    <div class="mobile-menu-overlay"></div>
    <div class="container-main">
        <nav class="services-menu">
            <ul class="services-nav">
                <li><a href="/"><i class="fas fa-home"></i> ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a></li>
                <li><a href="/#jozveh"><i class="fas fa-book"></i> Ø¬Ø²ÙˆÙ‡ ÙŠØ§Ø¨</a></li>
                <li><a href="/#welfare"><i class="fas fa-users"></i> Ø®Ø¯Ù…Ø§Øª ØºÙŠØ±Ø­Ø¶ÙˆØ±ÙŠ</a></li>
                <li><a href="/#map"><i class="fas fa-directions"></i> Ù…Ú©Ø§Ù† ÙŠØ§Ø¨ÙŠ Ø¯Ø± Ø¯Ø§Ù†Ø´Ú¯Ø§Ù‡</a></li>
                <li><a href="/#DISCOUNT"><i class="fas fa-tags"></i> ØªØ®ÙÙŠÙ Ù‡Ø§</a></li>
                <li><a href="/#aboutus"><i class="fas fa-info-circle"></i> Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a></li>
                <li><a href="/#contact"><i class="fas fa-headset"></i> ØªÙ…Ø§Ø³ Ø¨Ø§ Ø§Ø¯Ù…ÙŠÙ†</a></li>
            </ul>
        </nav>

        <main>
            <div class="service-item" data-category="DISCOUNT">
                <h2><i class="fas fa-tags"></i> Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ØªØ®ÙÛŒÙ ÙØ³Øªâ€ŒÙÙˆØ¯ Ùˆ Ø±Ø³ØªÙˆØ±Ø§Ù† Ù‡Ø§</h2>
                <div id="vouchers-section">
                    <div class="vouchers-container" id="vouchers-container">
                        <div id="loading-vouchers">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ØªØ®ÙÛŒÙ...</div>
                    </div>
                </div>

                <div id="reservation-form">
                    <h3>ÙØ±Ù… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ùˆ Ù¾ÛŒØ´â€ŒÙ¾Ø±Ø¯Ø§Ø®Øª ØªØ®ÙÛŒÙ</h3>
                    <div class="formcontainer">
                        <form id="DiscountForm">
                            <label>Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÙŠ: <input type="text" id="fullName_discount" required></label>
                            <label>Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ (Ù…Ø§Ù†Ù†Ø¯ Ù…Ø«Ø§Ù„): 
                                <input type="text" id="phoneNumber_discount" inputmode="numeric" pattern="^09\d{9}$" placeholder="Ù…Ø«Ù„Ø§Ù‹: 09123456789" required>
                            </label>
                            <label>Ø³Ù‡ Ø±Ù‚Ù… Ø¢Ø®Ø± Ø´Ù…Ø§Ø±Ù‡ Ø¯Ø§Ù†Ø´Ø¬ÙˆÙŠÙŠ/Ù¾Ø±Ø³Ù†Ù„ÙŠ: 
                                <input type="text" id="DiscountVerifCode" inputmode="numeric" placeholder="Ù…Ø«Ù„Ø§Ù‹: 123" pattern="\d{3}" maxlength="3" required>
                            </label>

                            <!-- hidden inputs to receive selected card info from the voucher list -->
                            <input type="hidden" id="selectedStoreName" name="store_name" value="">
                            <input type="hidden" id="selectedCardLabel" name="dis_card_label" value="">

                            <div id="captchaContainer_discount">
                                <div id="captchaQuestion_discount" style="padding: 10px; margin: 10px 0; background: #f0f0f0; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; font-weight: bold; text-align: center; color: #000;"></div>
                                <label for="captchaAnswer_discount">Ù¾Ø§Ø³Ø® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÙŠØ¯:</label>
                                <input type="number" id="captchaAnswer_discount" placeholder="" required>
                            </div>

                            <div id="captchaError_discount" style="color:red; display:none;">âŒ Ù¾Ø§Ø³Ø® Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.</div>
                            <button type="submit">ØªØ§ÙŠÙŠØ¯ Ø«Ø¨Øª Ù†Ø§Ù…</button>
                        </form>
                        <div id="DiscountRequestStatus"></div> 
                        <div id="DiscountSuccessMessage">
                            âœ… ØªØ®ÙÙŠÙ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÙŠØª Ø«Ø¨Øª Ø´Ø¯!<br><br>
                            <span style="color: blue;">Ù…Ù‡Ù„Øª Ø§Ø³ØªÙØ§Ø¯Ù‡: 30 Ø¢Ø¨Ø§Ù† 1404ØŒ Ø³Ø§Ø¹Øª 24:00.</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <footer>
        <div class="container">
            <p>Â© <span id="current-year"></span> Ú©Ù„ÙŠÙ‡ Ø­Ù‚ÙˆÙ‚ Ø§ÙŠÙ† Ø³Ø§Ù…Ø§Ù†Ù‡ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ø¯Ø²ÙŠÙˆÙ†ÙŠ Ø§Ø³Øª.</p>
            <div class="telegram-contact"><a href="https://t.me/dezuni_admin" target="_blank"><i class="fab fa-telegram"></i> Ù¾Ø´ØªÙŠØ¨Ø§Ù†ÙŠ ØªÙ„Ú¯Ø±Ø§Ù…: @dezuni_admin</a></div>
        </div>
    </footer>

    <script>
        document.getElementById('current-year').textContent = new Date().getFullYear();

        const CURRENT_CATEGORY = 'fastfood';

        function formatToToman(value) {
            const num = parseInt(value) || 0;
            return new Intl.NumberFormat('fa-IR').format(num) + ' Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†';
        }

        let selectedStoreName = '';
        let selectedCardLabel = '';
        let correctCaptchaAnswer = 0;

        function generateCaptcha() {
            const a = Math.floor(Math.random() * 10) + 1;
            const b = Math.floor(Math.random() * 10) + 1;
            correctCaptchaAnswer = a + b;
            document.getElementById('captchaQuestion_discount').textContent = `Ø­Ø§ØµÙ„ Ø¬Ù…Ø¹ ${a} + ${b} Ú†Ù†Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŸ`;
        }

        function escapeHtml(str) {
            if (!str && str !== 0) return '';
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;');
        }

        async function handleFormSubmit(e) {
            e.preventDefault();

            const statusEl = document.getElementById('DiscountRequestStatus');
            const successEl = document.getElementById('DiscountSuccessMessage');

            const userAnswer = parseInt(document.getElementById('captchaAnswer_discount').value);
            if (userAnswer !== correctCaptchaAnswer) {
                document.getElementById('captchaError_discount').style.display = 'block';
                generateCaptcha();
                return;
            }

            const currentDate = new Date();
            // Ù…Ø«Ø§Ù„: Ø³Øª Ú©Ø±Ø¯Ù† Ø²Ù…Ø§Ù† Ø§Ù†Ù‚Ø¶Ø§ (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¢Ù† Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯)
            const deadline = new Date(2026, 10, 18, 23, 59, 59); // ØªÙˆØ¬Ù‡: Ù…Ø§Ù‡Ù‡Ø§ Ø§Ø² 0 Ø´Ø±ÙˆØ¹ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
            if (currentDate > deadline) {
                statusEl.textContent = 'âŒ Ù…Ù‡Ù„Øª Ø«Ø¨Øª Ù†Ø§Ù… Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯Ù‡ Ø§Ø³Øª.';
                statusEl.style.color = 'red';
                return;
            }

            const formData = new FormData();
            formData.append("phone", document.getElementById("phoneNumber_discount").value);
            formData.append("name", document.getElementById("fullName_discount").value);
            formData.append("password", document.getElementById("DiscountVerifCode").value);
            formData.append("time_used", "");
            formData.append("date_used", "");
            formData.append("Registration_Date", new Date().toISOString().split('T')[0]);
            formData.append("date of register", new Date().toISOString().split('T')[0]);

            // read selected values from hidden inputs (or fall back to variables)
            const storeValue = selectedStoreName || document.getElementById('selectedStoreName')?.value || '';
            const labelValue = selectedCardLabel || document.getElementById('selectedCardLabel')?.value || '';
            formData.append("store_name", storeValue);
            formData.append("dis_card_label", labelValue);

            statusEl.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...';
            statusEl.style.color = '#3b82f6';

            try {
                const response = await fetch("https://script.google.com/macros/s/AKfycbxsFfdn1ytXmez9Qa4I89xRir_Zppg7cQQpltPhHZtN51dIkT-OrioHu8iI1v5Vhehb/exec", {
                    method: "POST",
                    body: formData
                });

                const text = await response.text();
                statusEl.textContent = '';
                successEl.style.display = 'block';
                document.getElementById('DiscountForm').reset();
                generateCaptcha();
                selectedStoreName = '';
                selectedCardLabel = '';
                // also clear hidden inputs
                document.getElementById('selectedStoreName').value = '';
                document.getElementById('selectedCardLabel').value = '';

            } catch (err) {
                console.error(err);
                statusEl.textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.';
                statusEl.style.color = 'red';
            }
        }

        async function loadVouchers() {
            const container = document.getElementById('vouchers-container');
            const API_URL = 'https://script.google.com/macros/s/AKfycbxfBqJKr9LPQzJMFMGZi7VIc2IS1ts9_AyMpgV_AHbiwAIoUfK421MhnS--t6OuAnOlEw/exec';

            try {
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡');
                const cards = await response.json();

                container.innerHTML = '';

                if (!Array.isArray(cards) || cards.length === 0) {
                    container.innerHTML = '<p style="text-align:center; color:#888;">Ù‡ÛŒÚ† Ú©Ø§Ø±ØªÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.</p>';
                    return;
                }

                const filteredCards = cards.filter(card =>
                    card.dis_card_id && card.dis_card_id.trim().toLowerCase() === CURRENT_CATEGORY.toLowerCase()
                );

                if (filteredCards.length === 0) {
                    container.innerHTML = '<p style="text-align:center; color:#888;">Ø¯Ø± Ø§ÛŒÙ† Ø¯Ø³ØªÙ‡ Ú©Ø§Ø±ØªÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.</p>';
                    return;
                }

                let hasActive = false;

                // Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø§Ù…Ù†â€ŒØªØ± Ø§Ø² template literal Ø§Ù…Ø§ Ø¨Ø§ escape Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                filteredCards.forEach((card, index) => {
                    const isActive = card.status === 'active';
                    if (isActive) hasActive = true;

                    const cardId = (card.dis_card_id || 'card') + '-' + (card.title || 'card').replace(/\s+/g, '_').replace(/[^\w\-]/g, '');
                    const hasAddress = card.address && card.address.trim() !== '';

                    const safeTitle = escapeHtml(card.title || 'Ú©Ø§Ø±Øª ØªØ®ÙÛŒÙ');
                    const safeCredit = formatToToman(card.credit);
                    const safeDisAmo = formatToToman(card.dis_amo);
                    const safeTotal = formatToToman(card.total_pay);
                    const safeInShop = formatToToman(card.in_shop_pay);
                    const safeAdv = formatToToman(card.adv_pay);
                    const safeExpire = typeof card.expire_date === 'string' ? escapeHtml(card.expire_date) : 'Ù…Ø´Ø®Øµ Ù†Ø´Ø¯Ù‡';

                    // Ø³Ø§Ø®ØªØ§Ø± Ú©Ø§Ø±Øª Ø¨Ø§ data- attributes
                    const cardHtml = `
                        <div class="voucher-card ${!isActive ? 'dimmed' : ''}">
                            <div class="voucher-title">${safeTitle}</div>
                            <div class="voucher-item"><span class="voucher-label">Ù…Ø¨Ù„Øº Ø§Ø¹ØªØ¨Ø§Ø±:</span><span class="voucher-value credit">${safeCredit}</span></div>
                            <div class="voucher-item"><span class="voucher-label">Ù…Ø¨Ù„Øº ØªØ®ÙÛŒÙ:</span><span class="voucher-value discount">${safeDisAmo}</span></div>
                            <div class="divider"></div>
                            <div class="voucher-item"><span class="voucher-label">Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„:</span><span class="voucher-value total">${safeTotal}</span></div>
                            <div class="voucher-item"><span class="voucher-label">Ù¾Ø±Ø¯Ø§Ø®Øª Ø¯Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡:</span><span class="voucher-value inshop">${safeInShop}</span></div>
                            <div class="voucher-item"><span class="voucher-label">Ù¾ÛŒØ´ Ù¾Ø±Ø¯Ø§Ø®Øª:</span><span class="voucher-value advance">${safeAdv}</span></div>
                            <div class="divider"></div>
                            <div class="voucher-item"><span class="voucher-label">ØªØ§Ø±ÛŒØ® Ø§Ù†Ù‚Ø¶Ø§ÛŒ Ú©Ø§Ø±Øª ØªØ®ÙÛŒÙ:</span><span class="voucher-value" style="color:#6b7280; font-weight:normal;">${safeExpire}</span></div>
                            ${isActive ? `<a href="#" class="deposit-link reserve-btn" data-store="${escapeHtml(card.store_name || '')}" data-label="${escapeHtml(card.dis_card_label || '')}">Ø±Ø²Ø±Ùˆ Ú©Ø§Ø±Øª ØªØ®ÙÛŒÙ</a>` : `<div class="deposit-link disabled">ØºÛŒØ±ÙØ¹Ø§Ù„</div>`}
                            <div class="voucher-help-text">ØªÙˆØ¶ÛŒØ­: ÙÙ‚Ø· Ø¨Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª <strong>${safeTotal}</strong>ØŒ <strong>${safeCredit}</strong> Ø®Ø±ÛŒØ¯ Ú©Ù†!</div>
                            <div style="display: flex; justify-content: center; gap: 16px; flex-wrap: wrap; margin-top: 12px;">
                                <a href="#" class="help-link" data-helpid="${cardId}">ğŸ“Œ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¬Ø²Ø¦ÛŒâ€ŒØªØ±</a>
                                ${hasAddress ? `<a href="#" class="help-link address-toggle" data-addrid="${cardId}" style="color:#d97706;">ğŸ“ Ø¢Ø¯Ø±Ø³</a>` : ''}
                            </div>
                            <div id="help-text-${cardId}" class="voucher-help-text" style="display:none; margin-top:12px;"> <strong>Ú†Ú¯ÙˆÙ†Ù‡ Ú©Ø§Ø±Øª ØªØ®ÙÛŒÙ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŸ</strong><br>- Ø§Ø¨ØªØ¯Ø§ <strong>${safeAdv}</strong> Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†ÛŒØ¯ ØªØ§ Ú©Ø§Ø±Øª Ø±Ø²Ø±Ùˆ Ø´ÙˆØ¯.<br>- Ø³Ù¾Ø³ Ø¨Ø§ Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ØŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ <strong>${safeCredit}</strong> Ø§Ø¹ØªØ¨Ø§Ø±ØŒ ÙÙ‚Ø· <strong>${safeInShop}</strong> Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†ÛŒØ¯.<br>- Ø¯Ø± Ù…Ø¬Ù…ÙˆØ¹ØŒ Ø´Ù…Ø§ <strong>${safeTotal}</strong> Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ Ùˆ <strong>${safeDisAmo}</strong> ØªÙˆÙ…Ø§Ù† Ø³ÙˆØ¯ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯!</div>
                            ${hasAddress ? `<div id="address-text-${cardId}" class="address-text" style="display:none; margin-top:12px;">${escapeHtml(card.address)}</div>` : ''}
                        </div>
                    `;

                    container.innerHTML += cardHtml;
                });

                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† listenerÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ø² Ø¯Ø±Ø¬ HTML
                if (hasActive) {
                    document.getElementById('reservation-form').style.display = 'block';
                    // reserve buttons
                    document.querySelectorAll('.reserve-btn').forEach(btn => {
                        btn.addEventListener('click', function(e) {
                            e.preventDefault();
                            const store = this.getAttribute('data-store') || '';
                            const label = this.getAttribute('data-label') || '';
                            const storeInput = document.getElementById('selectedStoreName');
                            const labelInput = document.getElementById('selectedCardLabel');
                            if (storeInput) storeInput.value = store;
                            if (labelInput) labelInput.value = label;
                            selectedStoreName = store;
                            selectedCardLabel = label;
                            document.getElementById('reservation-form').scrollIntoView({ behavior: 'smooth' });
                        });
                    });

                    // help toggles
                    document.querySelectorAll('.help-link').forEach(link => {
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            const helpId = this.getAttribute('data-helpid');
                            if (helpId) {
                                const el = document.getElementById(`help-text-${helpId}`);
                                if (el) el.style.display = el.style.display === 'block' ? 'none' : 'block';
                            }
                        });
                    });

                    // address toggles
                    document.querySelectorAll('.address-toggle').forEach(link => {
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            const addrId = this.getAttribute('data-addrid');
                            if (addrId) {
                                const el = document.getElementById(`address-text-${addrId}`);
                                if (el) el.style.display = el.style.display === 'block' ? 'none' : 'block';
                            }
                        });
                    });

                    document.getElementById('DiscountForm').addEventListener('submit', handleFormSubmit);
                }

            } catch (error) {
                console.error('Ø®Ø·Ø§:', error);
                container.innerHTML = '<p style="text-align:center; color:red;">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.</p>';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadVouchers();
            generateCaptcha();
        });
    </script>

    <!-- ÙÙ‚Ø· Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù…Ù†ÙˆÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ (Ù†Ú¯Ù‡ Ø¯Ø§Ø± ÛŒØ§ ØªØºÛŒÛŒØ± Ø¨Ø¯Ù‡) -->
    <script src="./fastfood_script.js"></script>
</body>
</html>
